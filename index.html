<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GiftsMine üéÅ</title>
<style>
body{margin:0;font-family:Segoe UI,sans-serif;color:#fff;display:flex;flex-direction:column;height:100vh;user-select:none;overflow:hidden;background:#111;background-size:cover;background-position:center;}
#balance{padding:15px;text-align:right;font-size:1.2em;font-weight:bold;background:rgba(0,0,0,0.15);backdrop-filter:blur(5px);}
main{flex:1;overflow-y:auto;padding:10px;display:none;background:rgba(0,0,0,0.2);}
main.active{display:block;}
.tab-bar{display:flex;justify-content:space-around;background:rgba(0,0,0,0.2);padding:10px;border-top:2px solid #fff;}
.tab-bar button{flex:1;margin:0 5px;padding:10px;border:none;background:linear-gradient(135deg,#ff9a9e,#fad0c4);color:#fff;font-weight:bold;cursor:pointer;transition:0.3s;}
.tab-bar button.active{background:linear-gradient(135deg,#a1c4fd,#c2e9fb);}
.grid{display:grid;gap:5px;justify-content:center;}
.mine-cell,.block{aspect-ratio:1/1;background:#333;display:flex;align-items:center;justify-content:center;font-size:0.9em;font-weight:bold;cursor:pointer;transition:0.2s;touch-action:none;box-shadow:0 2px 6px rgba(0,0,0,0.2);position:relative;overflow:hidden;background-size:cover;background-position:center;}
.mine-cell.disabled{pointer-events:none;opacity:0.6;}
.mine-cell.revealed.safe{background:#4caf50;}
.mine-cell.revealed.mine{background:#f44336;}
.block-price{position:absolute;bottom:2px;right:2px;background:rgba(0,0,0,0.5);padding:2px 4px;font-size:0.7em;border-radius:2px;}
.inventory-list{display:flex;flex-wrap:wrap;gap:10px;}
.gift-item{background:#222;padding:10px;box-shadow:0 6px 16px rgba(0,0,0,0.5);font-size:0.9em;flex:1 1 45%;display:flex;align-items:center;gap:10px;}
.gift-anim{width:50px;height:50px;}
.flying{position:absolute;width:60px;height:60px;pointer-events:none;z-index:1000;}
#loader{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:9999;background:#000;}
#loaderAnimation{width:180px;height:180px;margin-bottom:20px;}
</style>
</head>
<body>

<div id="loader">
  <div id="loaderAnimation"></div>
  <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤...</p>
</div>

<div id="balance">–ë–∞–ª–∞–Ω—Å: 10000 <img src="ton.svg" style="width:16px;vertical-align:middle"></div>

<main id="menu" class="active">
<h2>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h2>
<p>–í—ã–±–∏—Ä–∞–π —Ä–µ–∂–∏–º –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –ø–æ–¥–∞—Ä–∫–∏!</p>
</main>

<main id="mine">
<h2>–®–∞—Ö—Ç–∞ ‚õèÔ∏è</h2>
<div class="grid" id="mineGrid" style="grid-template-columns:repeat(4,minmax(60px,1fr))"></div>
</main>

<main id="mines">
<h2>–ú–∏–Ω—ã üí£</h2>
<div class="grid mines-grid" id="minesGrid" style="grid-template-columns:repeat(5,minmax(50px,1fr))"></div>
</main>

<main id="inventory">
<h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å üéí</h2>
<div class="inventory-list" id="inventoryList"></div>
</main>

<div class="tab-bar">
<button onclick="showTab('menu')" id="tab-menu" class="active">–ú–µ–Ω—é</button>
<button onclick="showTab('mine')" id="tab-mine">–®–∞—Ö—Ç–∞</button>
<button onclick="showTab('mines')" id="tab-mines">–ú–∏–Ω—ã</button>
<button onclick="showTab('inventory')" id="tab-inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js"></script>
<script>
// --- –õ–æ–∞–¥–µ—Ä ---
lottie.loadAnimation({
  container:document.getElementById('loaderAnimation'),
  renderer:'svg',
  loop:true,
  autoplay:true,
  path:'animations/myLoader.json'
});
window.onload=()=>{setTimeout(()=>{document.getElementById('loader').style.display='none';preloadAssets();},2000);};

// --- –ë–∞–ª–∞–Ω—Å ---
let balance=10000; 
function updateBalance(){
  document.getElementById('balance').innerHTML=`–ë–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} <img src="ton.svg" style="width:16px;vertical-align:middle">`;
}

// --- –í–∫–ª–∞–¥–∫–∏ ---
function showTab(id){
  document.querySelectorAll('main').forEach(m=>m.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.tab-bar button').forEach(b=>b.classList.remove('active'));
  document.getElementById('tab-'+id).classList.add('active');
  if(id==='inventory') renderInventory();
}

// --- –ü–æ–¥–∞—Ä–∫–∏ ---
const gifts=[
{name:"Hypno Lollipop",price:1.77},{name:"Desk Calendar",price:1.31},{name:"B-Day Candle",price:1.32},{name:"Lol Pop",price:1.32},{name:"Lunar Snake",price:1.38},
{name:"Snake Box",price:1.36},{name:"Xmas Stocking",price:1.38},{name:"Whip Cupcake",price:1.38},{name:"Candy Cane",price:1.48},{name:"Pet Snake",price:1.58},
{name:"Jester Hat",price:1.62},{name:"Snoop Dogg",price:1.64},{name:"Homemade Cake",price:1.7},{name:"Holiday Drink",price:1.7},{name:"Jingle Bells",price:1.74},
{name:"Cookie Heart",price:1.75},{name:"Big Year",price:1.78},{name:"Party Sparkler",price:1.8},{name:"Winter Wreath",price:1.79},{name:"Swag Bag",price:1.91},
{name:"Tama Gadget",price:1.93},{name:"Ginger Cookie",price:1.95},{name:"Moon Pendant",price:1.96},{name:"Jack-in-the-Box",price:2.01},{name:"Spiced Wine",price:2.12},
{name:"Stellar Rocket",price:2.19},{name:"Star Notepad",price:2.32},{name:"Easter Egg",price:2.46},{name:"Restless Jar",price:2.5},{name:"Santa Hat",price:2.6},
{name:"Snow Globe",price:2.65},{name:"Hex Pot",price:2.7},{name:"Joyful Bundle",price:2.71},{name:"Lush Bouquet",price:2.84},{name:"Witch Hat",price:2.86},
{name:"Light Sword",price:3.13},{name:"Spy Agaric",price:3.2},{name:"Bow Tie",price:3.22},{name:"Eternal Candle",price:3.38},{name:"Bunny Muffin",price:3.34},
{name:"Jelly Bunny",price:3.43},{name:"Berry Box",price:3.58},{name:"Evil Eye",price:3.6},{name:"Snow Mittens",price:3.67},{name:"Valentine Box",price:4.2},
{name:"Snoop Cigar",price:4.26},{name:"Sakura Flower",price:4.77},{name:"Hanging Star",price:5.26},{name:"Jolly Chimp",price:5.34},{name:"Sleigh Bell",price:7.63},
{name:"Skull Flower",price:7.7},{name:"Crystal Ball",price:7.86},{name:"Record Player",price:7.91},{name:"Love Candle",price:7.94},{name:"Top Hat",price:7.99},
{name:"Trapped Heart",price:8.69},{name:"Love Potion",price:8.79},{name:"Flying Broom",price:9.45},{name:"Cupid Charm",price:11.26},{name:"Eternal Rose",price:13.71},
{name:"Ionic Dryer",price:14.21},{name:"Diamond Ring",price:16.39},{name:"Voodoo Doll",price:16.43},{name:"Mad Pumpkin",price:17.91},{name:"Toy Bear",price:19.3},
{name:"Vintage Cigar",price:23.98},{name:"Low Rider",price:24.8},{name:"Signet Ring",price:25.1},{name:"Neko Helmet",price:26.41},{name:"Electric Skull",price:31},
{name:"Kissed Frog",price:34},{name:"Swiss Watch",price:35},{name:"Sharp Tongue",price:39.69},{name:"Scared Cat",price:43.6},{name:"Genie Lamp",price:47.07},
{name:"Westside Sign",price:51.27},{name:"Bonded Ring",price:54.99},{name:"Gem Signet",price:72.98},{name:"Magic Potion",price:72.98},{name:"Ion Gem",price:83},
{name:"Astral Shard",price:95.97},{name:"Perfume Bottle",price:95.99},{name:"Loot Bag",price:90.1},{name:"Mini Oscar",price:123.89},{name:"Nail Bracelet",price:129.84},
{name:"Heroic Helmet",price:219.99},{name:"Precious Peach",price:379.99},{name:"Durov‚Äôs Cap",price:794.9},{name:"Heart Locket",price:1450},{name:"Plush Pepe",price:5199}
];

let inventory=[];

// --- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π ---
function preloadAssets(){
  gifts.forEach(g=>{
    fetch(`animations/${g.name}.json`).catch(()=>{});
  });
}

// --- –ü–æ–¥–±–æ—Ä –ø–æ–¥–∞—Ä–∫–∞ ---
function getGiftByPrice(blockPrice){
  let min=blockPrice*0.5, max=blockPrice*1.3;
  let pool=gifts.filter(g=>g.price>=min && g.price<=max);
  if(pool.length===0) pool=gifts;
  return pool[Math.floor(Math.random()*pool.length)];
}

// --- –®–∞—Ö—Ç–∞ ---
function renderMine(){
  const grid=document.getElementById('mineGrid'); grid.innerHTML='';
  for(let i=0;i<16;i++){ // 4x4
    let block=document.createElement('div'); block.className='block';
    let price=(1+Math.random()*5).toFixed(2);
    block.dataset.price=price;
    block.innerHTML=`<div class="block-price">${price} <img src="ton.svg" style="width:12px;vertical-align:middle"></div>`;
    block.onclick=()=>breakBlock(block);
    grid.appendChild(block);
  }
}

function breakBlock(block){
  if(block.classList.contains('broken')) return;
  let price=parseFloat(block.dataset.price);
  if(balance<price){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");return;}
  balance-=price; updateBalance();
  block.classList.add('broken'); block.style.background='#111'; block.innerHTML='';
  let gift=getGiftByPrice(price); inventory.push(gift); flyGift(gift,block);
  setTimeout(()=>{renderMine();},1000);
}

// --- –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–¥–∞—Ä–∫–∞ ---
function flyGift(gift,block){
  let flying=document.createElement('div'); flying.className='flying';
  document.body.appendChild(flying);
  lottie.loadAnimation({container:flying,renderer:'svg',loop:true,autoplay:true,path:`animations/${gift.name}.json`});
  let rect=block.getBoundingClientRect();
  flying.style.left=rect.left+'px'; flying.style.top=rect.top+'px';
  let inv=document.getElementById('inventoryList').getBoundingClientRect();
  flying.animate([{transform:`translate(0,0)`},{transform:`translate(${inv.left-rect.left}px,${inv.top-rect.top}px)`}],{duration:1000,easing:'ease-in-out'});
  setTimeout(()=>{document.body.removeChild(flying);renderInventory();},1000);
}

// --- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å ---
function renderInventory(){
  let list=document.getElementById('inventoryList'); list.innerHTML='';
  inventory.forEach(gift=>{
    let div=document.createElement('div'); div.className='gift-item';
    let anim=document.createElement('div'); anim.className='gift-anim';
    lottie.loadAnimation({container:anim,renderer:'svg',loop:true,autoplay:true,path:`animations/${gift.name}.json`});
    let info=document.createElement('span'); info.innerText=`${gift.name} (${gift.price} TON)`;
    div.appendChild(anim); div.appendChild(info);
    list.appendChild(div);
  });
}

// --- –ú–∏–Ω—ã ---
function renderMines(){
  const grid=document.getElementById('minesGrid'); grid.innerHTML='';
  for(let i=0;i<25;i++){
    let cell=document.createElement('div'); cell.className='mine-cell';
    cell.onclick=()=>revealMine(cell);
    grid.appendChild(cell);
  }
}
function revealMine(cell){cell.classList.add('revealed','safe');}

// --- –ó–∞–ø—É—Å–∫ ---
updateBalance(); renderMine(); renderMines();
</script>
</body>
</html>
