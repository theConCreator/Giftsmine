<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GiftsMine üéÅ</title>
<style>
body{margin:0;font-family:Segoe UI,sans-serif;color:#333;display:flex;flex-direction:column;height:100vh;user-select:none;overflow:hidden;background-size:cover;background-position:center;background-repeat:no-repeat;}
#balance{padding:15px;text-align:right;font-size:1.2em;font-weight:bold;background:rgba(255,255,255,0.3);backdrop-filter:blur(5px);position:relative;box-shadow:0 2px 8px rgba(0,0,0,0.3);}
main{flex:1;overflow-y:auto;padding:10px;display:none;background: rgba(255,255,255,0.5);}
main.active{display:block;}
.tab-bar{display:flex;justify-content:space-around;background: rgba(255,255,255,0.8);padding:10px;border-top:2px solid #fff;}
.tab-bar button{flex:1;margin:0 5px;padding:10px;border:none;background:linear-gradient(135deg,#ff9a9e,#fad0c4);color:#fff;font-weight:bold;cursor:pointer;transition:0.3s;}
.tab-bar button.active{background:linear-gradient(135deg,#a1c4fd,#c2e9fb);color:#333;}
.grid{display:grid;gap:5px;justify-content:center;}
.mines-grid{grid-template-columns: repeat(5, minmax(50px,1fr));}

.mine-cell,.block{aspect-ratio:1/1;background:#eee;border-radius:0;display:flex;align-items:center;justify-content:center;font-size:0.9em;font-weight:bold;cursor:pointer;transition:0.2s;touch-action:none;box-shadow:0 2px 6px rgba(0,0,0,0.2);position:relative;overflow:hidden;background-size:cover;background-position:center;}
.mine-cell.revealed.safe{background:#a4f9a4;}
.mine-cell.revealed.mine{background:#f96c6c;}
.mine-cell.revealed.other-mine{background:#888;}

.block-price{position:absolute;bottom:2px;right:2px;background:rgba(255,255,255,0.7);padding:2px 4px;font-size:0.7em;border-radius:2px;}

.inventory-list{display:flex;flex-wrap:wrap;gap:10px;}
.gift-item{background:#fff;padding:10px;box-shadow:0 6px 16px rgba(0,0,0,0.3);font-size:0.9em;flex:1 1 45%;display:flex;align-items:center;gap:10px;transition:0.3s;animation:fadeIn 0.5s;position:relative;}
.gift-item:hover{transform:scale(1.05);}
.gift-img{width:50px;height:50px;}
.stake-options{margin-bottom:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
#mineReward{border:2px dashed #aaa;padding:10px;margin-left:10px;border-radius:10px;min-width:150px;text-align:center;font-weight:bold;position:relative;}
button#collectReward{padding:10px;background:linear-gradient(135deg,#ff9a9e,#fad0c4);border:none;color:#fff;font-weight:bold;cursor:pointer;border-radius:8px;margin-left:10px;transition:0.3s;}
button#collectReward:hover{background:linear-gradient(135deg,#a1c4fd,#c2e9fb);}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
</style>
</head>
<body>

<div id="balance">–ë–∞–ª–∞–Ω—Å: 10000 TON</div>

<main id="menu" class="active">
<h2>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h2>
<p>–í—ã–±–∏—Ä–∞–π —Ä–µ–∂–∏–º –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –ø–æ–¥–∞—Ä–∫–∏!</p>
</main>

<main id="mine">
<h2>–®–∞—Ö—Ç–∞ ‚õèÔ∏è</h2>
<div class="grid" id="mineGrid" style="grid-template-columns:repeat(4,minmax(60px,1fr))"></div>
</main>

<main id="inventory">
<h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å üéí</h2>
<div class="inventory-list" id="inventoryList"></div>
</main>

<div class="tab-bar">
<button onclick="showTab('menu')" id="tab-menu" class="active">–ú–µ–Ω—é</button>
<button onclick="showTab('mine')" id="tab-mine">–®–∞—Ö—Ç–∞</button>
<button onclick="showTab('inventory')" id="tab-inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
</div>

<script>
// ---- –ë–∞–ª–∞–Ω—Å ----
let balance = 10000;
const balanceEl = document.getElementById('balance');
function updateBalance(){ balanceEl.innerText = `–ë–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} TON`; }

// ---- –§–æ–Ω—ã ----
const backgrounds = {menu:'url(images/menu.jpg)', mine:'url(images/mine.jpg)', inventory:'url(images/inventory.jpg)'};
function showTab(id){
    document.querySelectorAll('main').forEach(m=>m.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.tab-bar button').forEach(b=>b.classList.remove('active'));
    document.getElementById('tab-'+id).classList.add('active');
    document.body.style.backgroundImage = backgrounds[id]||'none';
    if(id==='inventory') renderInventory();
}

// ---- –ü–æ–¥–∞—Ä–∫–∏ ----
const rawGifts = [{name:"Hypno Lollipop",price:1.77},{name:"Desk Calendar",price:1.31},{name:"Lunar Snake",price:1.32},{name:"Plush Pepe",price:5199}]; // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫
const gifts = rawGifts.map(g=>({name:g.name,price:Math.round((g.price*(0.9+Math.random()*0.2))*10)/10,img:`emoji/${g.name}.json`})); 
let inventory=[];
function renderInventory(){
    const list=document.getElementById('inventoryList'); list.innerHTML='';
    inventory.forEach((item,index)=>{
        const div=document.createElement('div'); div.className='gift-item';
        const img=document.createElement('img'); img.className='gift-img'; img.src=item.img;
        const info=document.createElement('div'); info.innerText=item.name+' ‚Äì '+item.price+'t';
        const sellBtn=document.createElement('button'); sellBtn.innerText=`–ü—Ä–æ–¥–∞—Ç—å (${item.price}t)`; sellBtn.onclick=()=>{balance+=item.price;inventory.splice(index,1);renderInventory();updateBalance();};
        const withdrawBtn=document.createElement('button'); withdrawBtn.innerText='–í—ã–≤–µ—Å—Ç–∏'; withdrawBtn.onclick=()=>{alert('–ú–µ—Ö–∞–Ω–∏–∫–∞ –≤—ã–≤–æ–¥–∞ –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞')};
        div.appendChild(img); div.appendChild(info); div.appendChild(sellBtn); div.appendChild(withdrawBtn);
        list.appendChild(div);
    });
}

// ---- –®–∞—Ö—Ç–∞ ----
const oreTypes = [
  {name:'Coal',min:1,max:3,img:'images/ores/coal.png'},
  {name:'Iron',min:3,max:6,img:'images/ores/iron.png'},
  {name:'Gold',min:7,max:10,img:'images/ores/gold.png'},
  {name:'Diamond',min:11,max:15,img:'images/ores/diamond.png'},
  {name:'Emerald',min:15,max:20,img:'images/ores/emerald.png'}
];

let mineBlocks = [];

function generateMineGrid(){
  const grid = document.getElementById('mineGrid');
  grid.innerHTML='';
  mineBlocks = [];
  for(let i=0;i<16;i++){
    const ore = oreTypes[Math.floor(Math.random()*oreTypes.length)];
    const price = +(Math.random()*(ore.max-ore.min)+ore.min).toFixed(2);
    const block = document.createElement('div');
    block.className='block';
    block.style.backgroundImage = `url(${ore.img})`;
    const priceLabel = document.createElement('div');
    priceLabel.className='block-price';
    priceLabel.innerText = price+'t';
    block.appendChild(priceLabel);
    grid.appendChild(block);
    let stage = 0;
    let interval=null;
    let holding=false;
    block.addEventListener('mousedown',()=>holding=true);
    block.addEventListener('mouseup',()=>holding=false);
    block.addEventListener('mouseleave',()=>holding=false);
    block.addEventListener('click',()=>{
        stage++;
        block.style.filter=`brightness(${1-stage*0.15})`;
        if(stage>=5){
            inventory.push(gifts[Math.floor(Math.random()*gifts.length)]);
            renderInventory();
            grid.removeChild(block);
        }
    });
    mineBlocks.push({block,ore,price,stage,holding});
  }
}
generateMineGrid();
</script>
</body>
</html>
