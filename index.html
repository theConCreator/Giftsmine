<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GiftsMine üéÅ</title>
  <style>
    @font-face { font-family:'Minecraft'; src:url('minecraft.ttf') format('truetype'); }
    body, html {
      margin:0; padding:0; height:100%;
      font-family:'Minecraft',sans-serif; color:#fff;
      overflow:hidden; display:flex; flex-direction:column;
      background:#000 center/cover no-repeat;
      transition: background 0.5s;
    }
    #balance { padding:15px; text-align:right; font-size:1.2em; font-weight:bold; background:rgba(0,0,0,0.25); backdrop-filter:blur(5px); box-shadow:0 2px 8px rgba(0,0,0,0.3); }
    main { flex:1; overflow-y:auto; padding:10px; padding-bottom:70px; display:none; background: rgba(0,0,0,0.2); }
    main.active{display:block;}
    h2{margin-top:0;text-align:center}
    .banner{width:100%;aspect-ratio:5/1;background:rgba(255,255,255,0.06);border-radius:10px;margin-bottom:15px;display:flex;align-items:center;justify-content:center;color:#ccc}
    .tab-bar {
      position: fixed; bottom: 0; left: 0; right: 0;
      display: flex; justify-content: space-between;
      background: rgba(0,0,0,0.25); padding: 10px 8px;
      border-top: 2px solid #fff; z-index: 1000;
      box-sizing: border-box;
    }
    .tab-bar button {
      flex: 1; margin: 0 4px; padding: 10px;
      font-size: 1em; border-radius: 10px; transition: 0.25s;
      background: rgba(0,0,0,0.6); color:#fff; border:none; font-weight:bold;
    }
    .tab-bar button.active { background: rgba(255,255,255,0.25); }
    button {
      background: rgba(0,0,0,0.6); color:#fff; border:none;
      border-radius:8px; padding:8px 10px; cursor:pointer; font-weight:bold;
      transition:0.3s;
    }
    button:hover { background: rgba(255,255,255,0.2); }
    .grid { display:grid; gap:5px; justify-content:center; }
    #mineGrid { grid-template-columns: repeat(4, minmax(60px,1fr)); }
    .block {
      aspect-ratio:1/1; background:#333; display:flex;
      align-items:center; justify-content:center; cursor:pointer;
      transition:0.2s; position:relative; overflow:hidden;
      background-size:cover; background-position:center;
      border-radius:6px; image-rendering: pixelated;
    }
    .block-price, .block-timer {
      position:absolute; font-size:0.65em; padding:2px 4px;
      border-radius:4px; background:rgba(0,0,0,0.55);
      display:flex; align-items:center; gap:2px;
    }
    .block-price { bottom:2px; right:2px; }
    .block-timer { top:2px; left:2px; }
    .block.cooldown { filter:brightness(0.5); cursor:not-allowed; }
    .inventory-list { display:flex; flex-direction:column; gap:12px; }
    .gift-item { display:flex; flex-direction:column; background: rgba(20,20,20,0.95); border-radius:10px; padding:10px; box-shadow:0 4px 12px rgba(0,0,0,0.5); color:#fff; }
    .gift-top { display:flex; gap:10px; align-items:center; margin-bottom:8px; }
    .gift-preview { width:60px; height:60px; flex-shrink:0; border-radius:6px; overflow:hidden; background:#111; display:flex; align-items:center; justify-content:center; }
    .gift-info { display:flex; flex-direction:column; justify-content:center; gap:4px; flex-grow:1; }
    .gift-name { font-size:1em; font-weight:bold; }
    .gift-price { font-size:0.9em; color:#ccc; }
    .gift-actions { display:flex; gap:10px; margin-top:6px; }
    .gift-actions button { flex:1; padding:6px; font-size:0.85em; }
    .flying { position:absolute; width:60px; height:60px; pointer-events:none; z-index:10000; }
    #loader {
      position:fixed; top:0; left:0; width:100%; height:100%;
      display:flex; align-items:center; justify-content:center;
      flex-direction:column; z-index:9999; background:#000;
      transition:opacity 0.6s ease;
    }
    #loader.hidden { opacity:0; pointer-events:none; }
    #loaderAnimation { width:120px; height:120px; margin-bottom:15px; }
    #loaderProgress { width:50%; height:14px; background:#333; border-radius:10px; overflow:hidden; }
    #loaderProgressBar { width:0%; height:100%; background:#ff9a9e; transition:width 0.3s; }
    input[type="text"]{padding:8px;border-radius:8px;border:none;background:rgba(255,255,255,0.1);color:#fff;font-weight:bold;width:100%;}
    .balance-section { margin:15px 0; padding:10px; background:rgba(0,0,0,0.35); border-radius:10px; }
    .balance-buttons button{width:100%; margin-bottom:8px;}
    @media (max-width:500px){ .tab-bar button{font-size:0.85em;padding:8px;} #balance{font-size:1em;padding:10px;} #mineGrid{gap:3px;} }
  </style>
</head>
<body>
<div id="loader">
  <div id="loaderAnimation"></div>
  <div id="loaderProgress"><div id="loaderProgressBar"></div></div>
  <p style="color:#fff;font-size:1.1em;margin-top:8px">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤...</p>
</div>

<div id="balance">–ë–∞–ª–∞–Ω—Å: 10000 <img src="ton.svg" style="width:16px;vertical-align:middle"></div>

<main id="menu" class="active">
  <h2>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h2>
  <a href="https://t.me/theConCreator" target="_blank" class="banner">
    <img src="images/banner.jpg" alt="–†–µ–∫–ª–∞–º–∞" style="width:100%; height:100%; object-fit:cover; border-radius:10px;">
  </a>
  <p style="text-align:center;color:#bbb">–í—ã–±–∏—Ä–∞–π —Ä–µ–∂–∏–º –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –ø–æ–¥–∞—Ä–∫–∏!</p>
</main>

<main id="mine">
  <h2>–®–∞—Ö—Ç–∞</h2>
  <div id="brokenBlocks" style="text-align:center;margin-bottom:12px">–°–ª–æ–º–∞–Ω–æ –±–ª–æ–∫–æ–≤: 0</div>
  <div class="grid" id="mineGrid"></div>
</main>

<main id="inventory">
  <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
  <div class="inventory-list" id="inventoryList"></div>
</main>

<main id="balanceTab">
  <h2>–ë–∞–ª–∞–Ω—Å</h2>
  <div class="balance-section">
    <h3>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h3>
    <div class="balance-buttons">
      <button onclick="addBalance('TON')"><img src="icons/ton.svg" style="width:16px;vertical-align:middle"> TON-–∫–æ—à–µ–ª—ë–∫ (0% –∫–æ–º–∏—Å—Å–∏—è)</button>
      <button onclick="addBalance('CryptoBot')"><img src="icons/cryptobot.svg" style="width:16px;vertical-align:middle"> CryptoBot (5% –∫–æ–º–∏—Å—Å–∏—è)</button>
      <button onclick="addBalance('Stars')"><img src="icons/stars.svg" style="width:16px;vertical-align:middle"> Telegram Stars (20% –∫–æ–º–∏—Å—Å–∏—è)</button>
    </div>
  </div>
  <div class="balance-section">
    <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</h3>
    <p>+0.5% –∫ –±–æ–Ω—É—Å—É —Å –¥–µ–ø–æ–∑–∏—Ç–æ–≤ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–π —Å–ª–æ–º–∞–Ω–Ω—ã–π –±–ª–æ–∫ (–º–∞–∫—Å–∏–º—É–º 20%).</p>
    <p id="refPercent">–¢–µ–∫—É—â–∏–π –±–æ–Ω—É—Å: 1%</p>
  </div>
  <div class="balance-section">
    <h3>–ü—Ä–æ–º–æ–∫–æ–¥</h3>
    <input type="text" id="promoCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
    <button style="margin-top:8px;width:100%" onclick="redeemPromo()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
  </div>
  <div class="balance-section">
    <h3>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
    <div id="transactionHistory"></div>
  </div>
</main>

<div class="tab-bar">
  <button onclick="showTab('menu')" id="tab-menu" class="active">–ú–µ–Ω—é</button>
  <button onclick="showTab('mine')" id="tab-mine">–®–∞—Ö—Ç–∞</button>
  <button onclick="showTab('inventory')" id="tab-inventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
  <button onclick="showTab('balanceTab')" id="tab-balanceTab">–ë–∞–ª–∞–Ω—Å</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js"></script>
<script>
// –õ–æ–∞–¥–µ—Ä
let loaderAnim=lottie.loadAnimation({container:document.getElementById('loaderAnimation'),renderer:'svg',loop:true,autoplay:true,path:'animations/myLoader.json'});

// –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let balance=10000,transactions=[],inventory=[],brokenBlocks=0,refPercent=1,firstMineCount=0;
const animationMap={};
const backgrounds={menu:'images/menu.jpg',mine:'images/mine.jpg',inventory:'images/inventory.jpg',balanceTab:'images/mobs.jpg'};
document.body.style.backgroundImage=`url(${backgrounds.menu})`;

// –§—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
function updateBalance(){document.getElementById('balance').innerHTML=`–ë–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} <img src="ton.svg" style="width:16px;vertical-align:middle">`;}
function updateTransactionHistory(){const el=document.getElementById('transactionHistory'); el.innerHTML=transactions.map(t=>`<div style="padding:4px 0;font-size:0.85em;color:#ddd">${t}</div>`).join('');}
function updateBrokenBlocks(){document.getElementById('brokenBlocks').textContent=`–°–ª–æ–º–∞–Ω–æ –±–ª–æ–∫–æ–≤: ${brokenBlocks}`; document.getElementById('refPercent').textContent=`–¢–µ–∫—É—â–∏–π –±–æ–Ω—É—Å: ${Math.min(refPercent,20).toFixed(1)}%`;}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
function showTab(id){
  document.querySelectorAll('main').forEach(m=>m.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.tab-bar button').forEach(b=>b.classList.remove('active'));
  document.getElementById('tab-'+id).classList.add('active');
  document.body.style.backgroundImage=`url(${backgrounds[id]})`;
  if(id==='inventory') renderInventory();
}

// –ü–æ–¥–∞—Ä–∫–∏ (–ø—Ä–∏–º–µ—Ä, —Å–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
const gifts = [
      {name:"Hypno Lollipop",price:1.77}, {name:"Desk Calendar",price:1.31},
      {name:"B-Day Candle",price:1.32}, {name:"Lol Pop",price:1.32},
      {name:"Lunar Snake",price:1.38}, {name:"Snake Box",price:1.36},
      {name:"Xmas Stocking",price:1.38}, {name:"Whip Cupcake",price:1.38},
      {name:"Candy Cane",price:1.48}, {name:"Pet Snake",price:1.58},
      {name:"Jester Hat",price:1.62}, {name:"Snoop Dogg",price:1.64},
      {name:"Homemade Cake",price:1.7}, {name:"Holiday Drink",price:1.7},
      {name:"Jingle Bells",price:1.74}, {name:"Cookie Heart",price:1.75},
      {name:"Big Year",price:1.78}, {name:"Party Sparkler",price:1.8},
      {name:"Winter Wreath",price:1.79}, {name:"Swag Bag",price:1.91},
      {name:"Tama Gadget",price:1.93}, {name:"Ginger Cookie",price:1.95},
      {name:"Moon Pendant",price:1.96}, {name:"Jack-in-the-Box",price:2.01},
      {name:"Spiced Wine",price:2.12}, {name:"Stellar Rocket",price:2.19},
      {name:"Star Notepad",price:2.32}, {name:"Easter Egg",price:2.46},
      {name:"Restless Jar",price:2.5}, {name:"Santa Hat",price:2.6},
      {name:"Snow Globe",price:2.65}, {name:"Hex Pot",price:2.7},
      {name:"Joyful Bundle",price:2.71}, {name:"Lush Bouquet",price:2.84},
      {name:"Witch Hat",price:2.86}, {name:"Light Sword",price:3.13},
      {name:"Spy Agaric",price:3.2}, {name:"Bow Tie",price:3.22},
      {name:"Eternal Candle",price:3.38}, {name:"Bunny Muffin",price:3.34},
      {name:"Jelly Bunny",price:3.43}, {name:"Berry Box",price:3.58},
      {name:"Evil Eye",price:3.6}, {name:"Snow Mittens",price:3.67},
      {name:"Valentine Box",price:4.2}, {name:"Snoop Cigar",price:4.26},
      {name:"Sakura Flower",price:4.77}, {name:"Hanging Star",price:5.26},
      {name:"Jolly Chimp",price:5.34}, {name:"Sleigh Bell",price:7.63},
      {name:"Skull Flower",price:7.7}, {name:"Crystal Ball",price:7.86},
      {name:"Record Player",price:7.91}, {name:"Love Candle",price:7.94},
      {name:"Top Hat",price:7.99}, {name:"Trapped Heart",price:8.69},
      {name:"Love Potion",price:8.79}, {name:"Flying Broom",price:9.45},
      {name:"Cupid Charm",price:11.26}, {name:"Eternal Rose",price:13.71},
      {name:"Ionic Dryer",price:14.21}, {name:"Diamond Ring",price:16.39},
      {name:"Voodoo Doll",price:16.43}, {name:"Mad Pumpkin",price:17.91},
      {name:"Toy Bear",price:19.3}, {name:"Vintage Cigar",price:23.98},
      {name:"Low Rider",price:24.8}, {name:"Signet Ring",price:25.1},
      {name:"Neko Helmet",price:26.41}, {name:"Electric Skull",price:31},
      {name:"Kissed Frog",price:34}, {name:"Swiss Watch",price:35},
      {name:"Sharp Tongue",price:39.69}, {name:"Scared Cat",price:43.6},
      {name:"Genie Lamp",price:47.07}, {name:"Westside Sign",price:51.27},
      {name:"Bonded Ring",price:54.99}, {name:"Gem Signet",price:72.98},
      {name:"Magic Potion",price:72.98}, {name:"Ion Gem",price:83},
      {name:"Astral Shard",price:95.97}, {name:"Perfume Bottle",price:95.99},
      {name:"Loot Bag",price:90.1}, {name:"Mini Oscar",price:123.89},
      {name:"Nail Bracelet",price:129.84}, {name:"Heroic Helmet",price:219.99},
      {name:"Precious Peach",price:379.99}, {name:"Durov‚Äôs Cap",price:794.9},
      {name:"Heart Locket",price:1450}, {name:"Plush Pepe",price:5199}
    ];

// –†—É–¥—ã
const oreTypes=[
  {img:"images/ores/coal.png",hits:3,min:1,max:5},
  {img:"images/ores/iron.png",hits:4,min:3,max:10},
  {img:"images/ores/gold.png",hits:5,min:6,max:20},
  {img:"images/ores/diamond.png",hits:6,min:10,max:50},
  {img:"images/ores/emerald.png",hits:7,min:15,max:70},
  {img:"images/ores/dirt.png",hits:2,min:0.1,max:1,type:"dirt"},
  {img:"images/ores/glass.png",hits:5,min:3,max:20,type:"glass"}
];

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞
function getGiftByPrice(price,isFirst=false){
  let min=price*0.5,max=price*3;
  let possible=gifts.filter(g=>g.price>=min && g.price<=max);
  if(possible.length===0) possible=gifts;
  return possible[Math.floor(Math.random()*possible.length)];
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–ª–æ–∫–∞
function spawnBlock(cell,index=0){
  const ore=oreTypes[Math.floor(Math.random()*oreTypes.length)];
  let price=+(ore.min+Math.random()*(ore.max-ore.min)).toFixed(2);
  cell.className="block"; cell.style.backgroundImage=`url(${ore.img})`;
  cell.innerHTML=`<div class="block-price">${price}<img src="ton.svg" style="width:12px;vertical-align:middle"></div>`;
  let hits=0;
  cell.onclick=()=>{
    if(balance<price) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");
    hits++;
    let stage=Math.floor(hits/ore.hits*9);
    cell.style.backgroundImage=`url(destroy/destroy_stage_${stage}.png), url(${ore.img})`;
    if(hits>=ore.hits){
      brokenBlocks++; updateBrokenBlocks();
      balance-=price; updateBalance();
      transactions.unshift(`–ü–æ—Ç—Ä–∞—á–µ–Ω–æ ${price.toFixed(2)} TON –Ω–∞ –±–ª–æ–∫`);
      updateTransactionHistory();

      if(ore.type==="dirt"){
        if(Math.random()<0.5){
          balance+=0.1; updateBalance();
          transactions.unshift("–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–ª–æ–∫–∞ +0.1 TON"); updateTransactionHistory();
          flyTon(cell,0.1);
        } else {
          let cheap=gifts.filter(g=>g.price<2);
          let gift=cheap[Math.floor(Math.random()*cheap.length)];
          inventory.push(gift); renderInventory(); flyGift(gift,cell);
        }
      } else if(ore.type==="glass"){
        let gift=gifts.filter(g=>g.price>=price*1.5 && g.price<=price*3);
        if(gift.length>0) gift=gift[Math.floor(Math.random()*gift.length)];
        else gift=getGiftByPrice(price);
        inventory.push(gift); renderInventory(); flyGift(gift,cell);
      } else {
        let gift=getGiftByPrice(price,index===0);
        inventory.push(gift); renderInventory(); flyGift(gift,cell);
      }

      let respawn=(60+Math.random()*1740)*1000;
      cell.classList.add("cooldown");
      cell.innerHTML=`<div class="block-timer">${Math.round(respawn/60000)}m</div>`;
      cell.onclick=null;
      setTimeout(()=>{ cell.classList.remove("cooldown"); spawnBlock(cell,index); },respawn);
    }
  };
}

// –õ–µ—Ç–∞—é—â–∏–π –ø–æ–¥–∞—Ä–æ–∫
function flyGift(gift, fromCell){
  const rect = fromCell.getBoundingClientRect();
  const fly = document.createElement('div');
  fly.className = 'flying';
  fly.style.left = rect.left + rect.width / 2 - 30 + 'px';
  fly.style.top  = rect.top  + rect.height / 2 - 30 + 'px';
  document.body.appendChild(fly);
  const anim = lottie.loadAnimation({container: fly,renderer: 'svg',loop:true,autoplay:true,path: `emoji/${gift.name}.json`});
  const invBtn = document.getElementById('tab-inventory').getBoundingClientRect();
  const targetX = invBtn.left + invBtn.width / 2 - 30;
  const targetY = invBtn.top  + invBtn.height / 2 - 30;
  fly.animate([{ transform: 'translate(0,0)' },{ transform: `translate(${targetX - (rect.left + rect.width / 2 - 30)}px, ${targetY - (rect.top + rect.height / 2 - 30)}px)` }], { duration: 1500, easing: 'ease-in-out' });
  setTimeout(()=>{ fly.remove(); anim.destroy(); },1500);
}

// –õ–µ—Ç–∞—é—â–∏–π TON
function flyTon(fromCell,amount){
  const rect = fromCell.getBoundingClientRect();
  const fly = document.createElement('div');
  fly.className = 'flying';
  fly.style.left = rect.left + rect.width/2 - 15 + 'px';
  fly.style.top  = rect.top  + rect.height/2 - 15 + 'px';
  fly.innerHTML = `<img src="ton.svg" style="width:30px"><span style="position:absolute;color:white;font-size:0.8em;font-weight:bold">${amount}</span>`;
  document.body.appendChild(fly);
  const bal = document.getElementById('balance').getBoundingClientRect();
  const targetX = bal.left + bal.width/2 - 15;
  const targetY = bal.top - 20;
  fly.animate([{ transform: 'translate(0,0)' },{ transform: `translate(${targetX - (rect.left + rect.width/2 - 15)}px, ${targetY - (rect.top + rect.height/2 - 15)}px)` }], { duration: 1200, easing: 'ease-in-out' });
  setTimeout(()=>fly.remove(),1200);
}

// –†–µ–Ω–¥–µ—Ä –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
function renderInventory(){
  const inv=document.getElementById('inventoryList');
  inv.innerHTML='';
  inventory.forEach((gift,i)=>{
    const item=document.createElement('div'); item.className='gift-item';
    item.innerHTML=`
      <div class="gift-top">
        <div class="gift-preview" id="preview-${i}"></div>
        <div class="gift-info">
          <div class="gift-name">${gift.name}</div>
          <div class="gift-price">${gift.price.toFixed(2)} TON</div>
        </div>
      </div>
      <div class="gift-actions">
        <button onclick="sellGift(${i})">–ü—Ä–æ–¥–∞—Ç—å</button>
        <button onclick="withdrawGift(${i})">–í—ã–≤–æ–¥</button>
      </div>`;
    inv.appendChild(item);
    const anim=lottie.loadAnimation({container:document.getElementById(`preview-${i}`),renderer:'svg',loop:true,autoplay:true,path:`emoji/${gift.name}.json`});
    animationMap[i]=anim;
  });
}

// –ü—Ä–æ–¥–∞–∂–∞ –∏ –≤—ã–≤–æ–¥
function sellGift(i){balance+=inventory[i].price;updateBalance();transactions.unshift(`–ü—Ä–æ–¥–∞–Ω ${inventory[i].name} +${inventory[i].price.toFixed(2)} TON`);updateTransactionHistory();inventory.splice(i,1);renderInventory();}
function withdrawGift(i){transactions.unshift(`–í—ã–≤–µ–¥–µ–Ω ${inventory[i].name}`);updateTransactionHistory();inventory.splice(i,1);renderInventory();}

// –ë–∞–ª–∞–Ω—Å
function addBalance(type){let a=prompt("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:");if(!a)return;a=parseFloat(a);if(isNaN(a)||a<=0)return;let comm=0;if(type==='CryptoBot')comm=0.05;if(type==='Stars')comm=0.2;a=a*(1-comm);a+=a*(refPercent/100);balance+=a;updateBalance();transactions.unshift(`–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ ${type}: +${a.toFixed(2)} TON`);updateTransactionHistory();}
function redeemPromo(){let code=document.getElementById('promoCode').value.trim();if(code==='FREE100'){balance+=100;updateBalance();transactions.unshift("–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ–º–æ–∫–æ–¥ +100 TON");updateTransactionHistory();}}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
async function preloadResources(){
  const urls=[...Object.values(backgrounds),'animations/myLoader.json',...gifts.map(g=>`emoji/${g.name}.json`),...oreTypes.map(o=>o.img),...Array.from({length:10},(_,i)=>`destroy/destroy_stage_${i}.png`)];
  let loaded=0;
  for(const url of urls){
    try{await fetch(url);loaded++;document.getElementById('loaderProgressBar').style.width=((loaded/urls.length)*100)+'%';}
    catch(e){console.warn("skip",url);}
  }
  setTimeout(()=>{document.getElementById('loader').classList.add('hidden');showTab('menu');},500);
}
function initMine(){const grid=document.getElementById('mineGrid');for(let i=0;i<12;i++){const cell=document.createElement('div');cell.className='block';grid.appendChild(cell);spawnBlock(cell,i);}}
function init(){updateBalance();updateTransactionHistory();updateBrokenBlocks();initMine();preloadResources();}
init();
</script>
</body>
</html>
